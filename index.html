// ‚úÖ Step 1: Setup base JavaScript game logic for browser version
// Rebuild core game loop from Python to JS
document.addEventListener('DOMContentLoaded', () => {
  const player = {
    energy: 100,
    fame: 0,
    searches: 0,
    specialEvents: 0,
    foundLegends: [],
  };

  const LEGEND_CHANCE = 1000000;
  const FAME_REQUIRED = 1000;

  const events = {
    "Coffee Break": { energy: +30, text: "You found an abandoned coffee shop! +30 energy" },
    "Bug Fix": { fame: +50, text: "You fixed a critical bug! +50 fame" },
    "Stack Overflow": { energy: -15, text: "You got lost on Stack Overflow! -15 energy" }
  };

  const statusEl = document.getElementById('status');
  const logEl = document.getElementById('log');
  const searchBtn = document.getElementById('search');
  const restBtn = document.getElementById('rest');

  function log(text) {
    const p = document.createElement('p');
    p.textContent = text;
    logEl.prepend(p);
  }

  function updateStatus() {
    statusEl.innerHTML = `
      Fame: ${player.fame}/${FAME_REQUIRED}<br>
      Energy: ${player.energy}/100<br>
      Searches: ${player.searches}<br>
      Special Events: ${player.specialEvents}<br>
      Legend: ${player.foundLegends.length ? 'üèÜ Found' : '‚ùå Not yet'}
    `;
  }

  function handleSpecialEvent() {
    if (Math.random() < 0.15) {
      const keys = Object.keys(events);
      const event = keys[Math.floor(Math.random() * keys.length)];
      const effect = events[event];
      player.energy = Math.max(0, player.energy + (effect.energy || 0));
      player.fame += effect.fame || 0;
      player.specialEvents++;
      log(`‚ö° ${event.toUpperCase()}: ${effect.text}`);
      return true;
    }
    return false;
  }

  function search() {
    if (player.energy < 10) {
      log("‚ö†Ô∏è Not enough energy to search!");
      return;
    }
    player.energy -= 10;
    player.searches++;
    log("üîç Searching...");

    if (!handleSpecialEvent()) {
      const isLegend = Math.floor(Math.random() * LEGEND_CHANCE) === 0;
      if (isLegend) {
        player.fame = FAME_REQUIRED;
        player.foundLegends.push("Kurucz Gergely");
        log("üéâ‚ú® YOU FOUND KURUCZ GERGELY! ‚ú®üéâ");
      } else {
        const fameGain = Math.floor(Math.random() * 10) + 1;
        player.fame += fameGain;
        log(`Found a random dev. +${fameGain} fame.`);
      }
    }
    updateStatus();
  }

  function rest() {
    const gain = Math.floor(Math.random() * 20) + 20;
    player.energy = Math.min(100, player.energy + gain);
    log(`üí§ You recovered ${gain} energy.`);
    updateStatus();
  }

  searchBtn.onclick = search;
  restBtn.onclick = rest;
  updateStatus();
});
